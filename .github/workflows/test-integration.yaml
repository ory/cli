name: dogfood integration test
on:
  workflow_dispatch:
  pull_request:
  push:
    branches:
      - main
      - master

env:
  # project & workspace are managed in Ory Cloud tech integration workspace.
  ORY_PROJECT_ID: "3b188173-833c-4074-995c-9085a72c8112"
  ORY_WORKSPACE_ID: "f77d4982-46f1-42cd-8d02-8bccfa54f8f7"
  ORY_WORKSPACE_API_KEY: ${{ secrets.ORY_WORKSPACE_API_KEY }}

jobs:
  gha:
    runs-on: ubuntu-latest
    container:
      image: oryd/ory:v1.1.0
      # temporary until we release new image
      options: --user root
    steps:
      - name: checkout
        uses: actions/checkout@v4
      # temporary until we release new image
      - name: add bash
        run: apk add bash
      - name: Check integration
        run: ory get project ${{ env.ORY_PROJECT_ID }}
